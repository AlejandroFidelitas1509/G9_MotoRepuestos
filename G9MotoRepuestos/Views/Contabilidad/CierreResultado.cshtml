@model List<G9MotoRepuestos.Models.Finanzas>

@{
    ViewData["Title"] = "Resultado del Cierre Contable";
    var tipo = (string)ViewBag.Tipo ?? "";
    DateTime fi = (DateTime)ViewBag.FechaInicio;
    DateTime ff = (DateTime)ViewBag.FechaFin;
    decimal ingresos = (decimal)ViewBag.TotalIngresos;
    decimal egresos = (decimal)ViewBag.TotalEgresos;
    decimal saldo = (decimal)ViewBag.SaldoFinal;
}

<div class="container">
    <h2 class="titulo">Resultado del Cierre Contable</h2>

    <div class="card">
        <h3 class="subtitulo">Resumen del periodo</h3>

        <div class="info">
            <p><strong>Tipo de Cierre:</strong> @tipo</p>
            <p><strong>Periodo:</strong> @fi.ToString("yyyy-MM-dd") a @ff.ToString("yyyy-MM-dd")</p>
            <p><strong>Estado:</strong> <span class="estado-exito">Cierre realizado exitosamente</span></p>
        </div>

        <hr class="divider" />

        <div class="totales">
            <div class="total-card ingreso">
                <p class="label">Total Ingresos</p>
                <p class="monto">₡@ingresos.ToString("N2")</p>
            </div>

            <div class="total-card egreso">
                <p class="label">Total Egresos</p>
                <p class="monto">₡@egresos.ToString("N2")</p>
            </div>

            <div class="total-card balance">
                <p class="label">Balance Final</p>
                <p class="monto">₡@saldo.ToString("N2")</p>
            </div>
        </div>
    </div>

    <div class="card">
        <h3 class="subtitulo">Movimientos incluidos en el cierre</h3>

        <table class="tabla">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Tipo</th>
                    <th>Monto</th>
                    <th>Categoría</th>
                    <th>Descripción</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var m in Model)
                {
                    var esIngreso = (m.Tipo ?? "").ToLower() == "ingreso";
                    <tr>
                        <td>@m.Fecha.ToString("yyyy-MM-dd")</td>
                        <td>@m.Tipo</td>
                        <td class="@(esIngreso ? "monto-ingreso" : "monto-egreso")">
                            @(esIngreso ? "+" : "-") ₡@m.Monto.ToString("N2")
                        </td>
                        <td>@m.Categoria</td>
                        <td>@m.Descripcion</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="botones">
        <a asp-controller="Contabilidad" asp-action="Index" class="btn">Volver al menú</a>
        <a asp-controller="Contabilidad" asp-action="Cierres" class="btn">Realizar otro cierre</a>
        <a asp-controller="Contabilidad" asp-action="Historial" class="btn">Ir al historial</a>
    </div>
</div>

<style>
    body {
        background: #f4f4f4;
    }

    .container {
        max-width: 850px;
        margin: 30px auto;
        background: #ffffff;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 0 10px rgba(0,0,0,0.10);
    }

    .titulo {
        text-align: center;
        font-size: 26px;
        margin-bottom: 25px;
        color: #c62828;
        font-weight: bold;
    }

    .subtitulo {
        font-size: 20px;
        margin-bottom: 15px;
        color: #c62828;
        font-weight: bold;
    }

    .card {
        background: #ffffff;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 25px;
        border: 1px solid #e0e0e0;
    }

    .info p {
        margin: 4px 0;
        font-size: 15px;
        color: #333333;
    }

    .estado-exito {
        color: #2e7d32;
        font-weight: bold;
    }

    .divider {
        margin: 15px 0;
        border: none;
        border-top: 1px solid #d0d0d0;
    }

    .totales {
        display: flex;
        gap: 15px;
        justify-content: space-between;
        flex-wrap: wrap;
    }

    .total-card {
        flex: 1;
        min-width: 180px;
        background: #fafafa;
        padding: 15px;
        border-radius: 12px;
        border: 1px solid #e0e0e0;
        text-align: center;
    }

        .total-card .label {
            color: #333333;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .total-card .monto {
            font-size: 22px;
            font-weight: bold;
        }

    .ingreso .monto {
        color: #2e7d32;
    }

    .egreso .monto {
        color: #c62828;
    }

    .balance .monto {
        color: #1565c0;
    }

    .tabla {
        width: 100%;
        border-collapse: collapse;
        border-radius: 10px;
        overflow: hidden;
    }

        .tabla th {
            background: #000000;
            color: white;
            padding: 10px;
            text-align: left;
        }

        .tabla td {
            padding: 10px;
            background: #ffffff;
            border-bottom: 1px solid #e0e0e0;
            color: #333333;
        }

    .monto-ingreso {
        color: #2e7d32;
        font-weight: bold;
    }

    .monto-egreso {
        color: #c62828;
        font-weight: bold;
    }

    .botones {
        display: flex;
        justify-content: space-between;
        margin-top: 25px;
        gap: 10px;
        flex-wrap: wrap;
    }

    .btn {
        padding: 12px 20px;
        text-decoration: none;
        background: #c62828;
        color: white;
        border-radius: 10px;
        font-size: 15px;
        font-weight: bold;
        transition: 0.2s;
    }

        .btn:hover {
            background: #b71c1c;
        }
</style>
